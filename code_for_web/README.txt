===============================================================================
=                    Matlab Code used for the article                         =
=        "Reviving a failed network through microscopic interventions"        =
=                         (Nature Physics 2021)                               =
===============================================================================

*Copyright (C) 2021  Hillel Sanhedrai <hillel.sanhedrai@gmail.com>

-------------------------------------------------------------------------------

Table of Content:

I.   Folders
II.  Run
III. Speciel files and subfolders
IV.  Known Issues

-------------------------------------------------------------------------------

I.   Folders

'code'   - Contains all code files to generate the figures in the article.
	
	   The code is organized in folders and files according to the figures in the paper.
	
	   Examples: In subfolder 'Figure3', the file 'panel3ef.m' generates the panels e and f in figure 3 of the article.
		     In subfolder 'Figure6_and_SI', the file 'SI9.m' generates figure 9 in the supplementary information, 
		     	and the file 'all_panels.m' generates all the panels of figure 6 and the rest of the figures in SI.

'data'   - Contains all data of real networks that we used in the article.

'output' - Here you will find all the figures which are generated by the code files in folder 'code'.
	   The figures are organized in folders 'Figure3', 'Figure4' and so on, named according to the panels in the article, e.g. 'b.pdf' for panel b.

-------------------------------------------------------------------------------

II.  Run

In order to run the code, you just have to download the main folder, and run in Matlab the file of the desired figure and panel.

Examples: To plot panel b in figure 3 of the paper, you should run the file 'panel_3b.m' in subfolder 'Figure3' in folder 'code'. 
	  Then a pdf file named 'b.pdf' will appear in subfolder 'Figure3' in folder 'output'.

	  To generate the table dataset1 in supplementary information, you have to run the file 'all_panels.m' in subfolder 'Figure6_and_SI', 
	  which generates all panels of figure 6 and figures of SI (except figure 9 which has a seperated code file).
	  Then the Excel file 'dataset1.xlsx' will apear in folder 'FiguresSI' in folder 'output'.

-------------------------------------------------------------------------------

III. Speciel files and subfolders

Folder 'code/functions' - Contains many functions used in the code files.
			  At the top lines of each code file there is a command that add the folder 'function' to the path.

Folder 'data' contains the files:

	'Brain.mat'
	'PPI_Human.mat'
	'PPI_Yeast.mat'
	
		all above three contain adjacency matrices of real networks as explained in the paper and SI.
	
	'Microbiome_Interactios_Table.mat'

		contains a table of all interactions between microbial species and metabolites as taken from the article referred in our article.
	
	'MicrobiomeNetworks.mat'

		contains the matrices we generated from the table 'Microbiome_Interactios_Table.mat' in code file 'ReadData.m' in folder 'code/Figure6_and_SI'	

File 'ReadData.m' in folder 'code/Figure6_and_SI'
	analyze the table 'Microbiome_Interactios_Table.mat' in folder 'data', 
	and constructs the matrices which represent the network between the microbiomes.

-------------------------------------------------------------------------------

IV.  Known Issues

Some of the codes run fast while others take a long time. 
In addition, in some cases the differential equations need a long maximal time in order to reach the steady state, 
where in other cases the system arrives a steady state in a short time.
Therefore, you might wish to control this parameter of maximal time.
This parameter is located in the folder 'functions' in file 'SolveOdes.m' in line 35 'Tmax'. The same is in file 'SolveOdesProbiotics.m' in line 36.
